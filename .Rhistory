overall = sum(total_jail_pop) / sum(total_pop))
View(var_2010)
var_2010 <- summarise(filter(var_compare_data, year == 2010),
latinx = sum(latinx_jail_pop) / sum(total_pop),
white = sum(white_jail_pop) / sum(total_pop),
black = sum(black_jail_pop) / sum(total_pop),
overall = sum(total_jail_pop) / sum(total_pop))
var_compare_data <- filter(filter(filter(refined_data, latinx_jail_pop != "NA"), latinx_pop_15to64 != "NA"), total_pop != "NA")
var_2010 <- summarise(filter(var_compare_data, year == 2010),
latinx = sum(latinx_jail_pop) / sum(total_pop),
white = sum(white_jail_pop) / sum(total_pop),
black = sum(black_jail_pop) / sum(total_pop),
overall = sum(total_jail_pop) / sum(total_pop))
var_compare_data <- filter(filter(filter(refined_data, latinx_jail_pop != "NA"), latinx_pop_15to64 != "NA"), total_jail_pop != "NA")
var_2010 <- summarise(filter(var_compare_data, year == 2010),
latinx = sum(latinx_jail_pop) / sum(total_pop),
white = sum(white_jail_pop) / sum(total_pop),
black = sum(black_jail_pop) / sum(total_pop),
overall = sum(total_jail_pop) / sum(total_pop))
var_2010 <- summarise(filter(var_compare_data, year == 2010),
latinx = sum(latinx_jail_pop) / sum(latinx_total_15to64),
white = sum(white_jail_pop) / sum(white_total_15to64),
black = sum(black_jail_pop) / sum(black_total_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
var_2010 <- summarise(filter(var_compare_data, year == 2010),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
overall_var_compare_df <- var_1990 + var_2000
View(overall_var_compare_df)
overall_var_compare_df <- merge(var_1990, var_2000)
overall_var_compare_df <- merge(var_1990, var_2000, by = latinx)
overall_var_compare_df <- merge(var_1990, var_2000, by = "latinx")
View(overall_var_compare_df)
var_2010 <- summarise(filter(var_compare_data, year == 2010),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
var_2000 <- summarise(filter(var_compare_data, year == 2000),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
var_1990 <- summarise(filter(var_compare_data, year == 1990),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
overall_var_compare_df <- merge(var_1990, var_2000, by = "latinx")
overall_var_compare_df <- merge(var_1990, var_2000, by.x = "latinx")
var_compare_data <- filter(filter(filter(refined_data, latinx_jail_pop != "NA"), latinx_pop_15to64 != "NA"), total_jail_pop != "NA")
var_2010 <- summarise(filter(var_compare_data, year == 2010),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
var_2000 <- summarise(filter(var_compare_data, year == 2000),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
var_1990 <- summarise(filter(var_compare_data, year == 1990),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
overall_var_compare_df <- var_1990
overall_var_compare_df$latinx [2] <- pull(var_2000$latinx)[1]
overall_var_compare_df$latinx [2] <- var_2000$latinx[1]
overall_var_compare_df$latinx [2] <- pull(select(var_2000, latinx)) [1]
overall_var_compare_df$latinx [2] <- pull(filter(var_2000, latinx == latinx)) [1]
overall_var_compare_df$latinx
overall_var_compare_df$latinx [2] <- 2
var_compare_data <- filter(filter(filter(filter(refined_data, latinx_jail_pop != "NA"), latinx_pop_15to64 != "NA"), white_pop_15to64 != "NA"), total_jail_pop != "NA")
var_compare_data <- filter(filter(filter(filter(refined_data, latinx_jail_pop != "NA"), latinx_pop_15to64 != "NA"), white_pop_15to64 != "NA"), total_jail_pop != "NA")
var_2010 <- summarise(filter(var_compare_data, year == 2010),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
var_2000 <- summarise(filter(var_compare_data, year == 2000),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
var_1990 <- summarise(filter(var_compare_data, year == 1990),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
trend_chart_adjusted_data <- filter(filter(filter(refined_data, latinx_jail_pop != "NA"),latinx_jail_pop != "NA"), total_jail_pop > 0)
trend_chart_adjusted_data <- summarise(group_by(trend_chart_adjusted_data, year), black_total_jail = sum(black_jail_pop), latinx_total_jail = sum(latinx_jail_pop), white_total_jail = sum(white_jail_pop), total_jail = sum(total_jail_pop))
plot(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$total_jail, pch = 15, ylim = c(0, 740000), main = "History of Jailed Population in the US", xlab = "Date", ylab = "Number of People in Jail")
lines(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$total_jail)
points(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$white_total_jail, pch = 16, col = "red")
lines(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$white_total_jail, col = "red")
points( x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$black_total_jail, pch = 17, col = "green")
lines(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$black_total_jail, col = "green")
points(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$latinx_total_jail, pch = 18, col = "blue")
lines(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$latinx_total_jail, col = "blue")
legend("topleft", c("Total American in Jail", "Total White American in Jail", "Total African American in Jail", "Total Latin American in Jail"),col = c("black", "red", "green", "blue"), pch = c(15, 16, 17, 18))
trend_chart_adjusted_data <- filter(filter(filter(refined_data, latinx_jail_pop != "NA"),white_jail_pop != "NA"), total_jail_pop > 0)
trend_chart_adjusted_data <- summarise(group_by(trend_chart_adjusted_data, year), black_total_jail = sum(black_jail_pop), latinx_total_jail = sum(latinx_jail_pop), white_total_jail = sum(white_jail_pop), total_jail = sum(total_jail_pop))
plot(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$total_jail, pch = 15, ylim = c(0, 740000), main = "History of Jailed Population in the US", xlab = "Date", ylab = "Number of People in Jail")
lines(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$total_jail)
points(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$white_total_jail, pch = 16, col = "red")
lines(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$white_total_jail, col = "red")
points( x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$black_total_jail, pch = 17, col = "green")
lines(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$black_total_jail, col = "green")
points(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$latinx_total_jail, pch = 18, col = "blue")
lines(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$latinx_total_jail, col = "blue")
legend("topleft", c("Total American in Jail", "Total White American in Jail", "Total African American in Jail", "Total Latin American in Jail"),col = c("black", "red", "green", "blue"), pch = c(15, 16, 17, 18))
specie <- c(rep("sorgho" , 3) , rep("poacee" , 3) , rep("banana" , 3) , rep("triticum" , 3) )
condition <- rep(c("normal" , "stress" , "Nitrogen") , 4)
value <- abs(rnorm(12 , 0 , 15))
data <- data.frame(specie,condition,value)
View(data)
var_2010 <- summarise(filter(var_compare_data, year == 2010),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
var_2010 <- mutate(var_2010, year = 2010)
View(var_2010)
a2010 <- colnames(var_2010)
df_catgory_2010 <- pull(filter(var_2010, latinx == latinx))[1:5]
df_catgory_2010 <- pull(filter(var_2010, latinx == latinx))[1]
df_catgory_2010 <- c(var_2010$latinx, var_2010$white, var_2010$black, var_2010$overall)
df_colname_2010 <- colnames(var_2010)
var_compare_data <- filter(filter(filter(filter(refined_data, latinx_jail_pop != "NA"), latinx_pop_15to64 != "NA"), white_pop_15to64 != "NA"), total_jail_pop != "NA")
var_2010 <- summarise(filter(var_compare_data, year == 2010),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
df_colname_2010 <- colnames(var_2010)
df_catgory_2010 <- c(var_2010$latinx, var_2010$white, var_2010$black, var_2010$overall)
df_colname_2010 <- colnames(var_2010)
df_catgory_2010 <- c(var_2010$latinx, var_2010$white, var_2010$black, var_2010$overall)
df_year_2010 <- c(2010, 2010, 2010, 2010)
df_colname_2010 <- colnames(var_2010)
df_catgory_2010 <- c(var_2010$latinx, var_2010$white, var_2010$black, var_2010$overall)
df_year_2010 <- c(2010, 2010, 2010, 2010)
df_2010_vc <- as.data.frame(race = df_colname_2010, value = df_catgory_2010, year = df_year_2010)
df_2010_vc <- as.data.frame(df_2010_vc, race = df_colname_2010, value = df_catgory_2010, year = df_year_2010)
overall_var_compare_df <- rbind(var_1990, var_2000, var_2010)
View(overall_var_compare_df)
#Pakcage---------------------------------------------------------------------------
library(dplyr)
library(ggplot2)
library(stringr)
library(viridis)
library(hrbrthemes)
#Data----------------------------------------------------------------------------------
overall_raw_data <-
read.csv("/Users/12064/a3-data-visualization-benedictwyt/incarceration-trends/incarceration_trends.csv")
refined_data <- select(overall_raw_data, year, state, county_name, total_pop,
total_pop_15to64, white_pop_15to64, black_pop_15to64, latinx_pop_15to64,
total_jail_pop, white_jail_pop, black_jail_pop, latinx_jail_pop)
refined_data <- arrange(refined_data, year)
#Values that worth attention----------------------------------------------------------
#Question 1: What is the averaged African American from age 15 to 64 proportion over years?
q1_further_adjusted <- filter(refined_data, black_pop_15to64 >= 0)
porportion_average_afram <-
sum(q1_further_adjusted$black_pop_15to64) / sum(q1_further_adjusted$total_pop_15to64)
porportion_average_afram <- round(porportion_average_afram, digits = 2)
#Question 2: Which county has the highest percentage of African American population in the most recent year?
q2_further_adjusted <- summarise(group_by(filter(q1_further_adjusted, year == max(year)), county_name),
state = state, proportion = black_pop_15to64 / total_pop_15to64)
county_with_highest_percent_aframpop <- sprintf("%s in %s.", pull(filter(q2_further_adjusted,
proportion == max(proportion)), county_name)[1],
pull(filter(q2_further_adjusted,
proportion == max(proportion)), state)[1])
#Question 3: what is the averaged African American in jail over years?
q3_further_adjusted <- filter(filter(refined_data, black_jail_pop >= 0), total_jail_pop >= 0)
porportion_averagejail_afram <-
sum(q3_further_adjusted$black_jail_pop) / sum(q3_further_adjusted$total_jail_pop)
porportion_averagejail_afram <- round(porportion_averagejail_afram, digits = 2)
#Question 4: What is the averaged white american from age 15 to 64 proportion over years?
q4_further_adjusted <- filter(refined_data, white_pop_15to64 >= 0)
porportion_average_white <-
sum(q4_further_adjusted$white_pop_15to64) / sum(q1_further_adjusted$total_pop_15to64)
porportion_average_white <- round(porportion_average_white, digits = 2)
#Question 5: what is the averaged white American in jail over years?
q5_further_adjusted <- filter(filter(refined_data, white_jail_pop >= 0), total_jail_pop >= 0)
porportion_averagejail_white <-
sum(q5_further_adjusted$white_jail_pop) / sum(q5_further_adjusted$total_jail_pop)
porportion_averagejail_white <- round(porportion_averagejail_white, digits = 2)
#Question 6: What is the averaged Latin American from age 15 to 64 proportion over years?
q6_further_adjusted <- filter(refined_data, latinx_pop_15to64 >= 0)
porportion_average_latinx <-
sum(q1_further_adjusted$latinx_pop_15to64) / sum(q1_further_adjusted$total_pop_15to64)
porportion_average_latinx <- round(porportion_average_latinx, digits = 2)
#Question 7: Which county has the highest percentage of Latin American population in the most recent year?
q7_further_adjusted <- summarise(group_by(filter(q6_further_adjusted, year == max(year)), county_name),
state = state, proportion = latinx_pop_15to64 / total_pop_15to64)
county_with_highest_percent_latinxpop <-
sprintf("%s in %s.", pull(filter(q7_further_adjusted, proportion == max(proportion)), county_name)[1],
pull(filter(q7_further_adjusted, proportion == max(proportion)), state)[1])
#Question 8: what is the averaged African American in jail over years?
q8_further_adjusted <- filter(filter(refined_data, latinx_jail_pop >= 0), total_jail_pop >= 0)
porportion_averagejail_latinx <-
sum(q8_further_adjusted$latinx_jail_pop) / sum(q8_further_adjusted$total_jail_pop)
porportion_averagejail_latinx <- round(porportion_averagejail_latinx, digits = 2)
#Trends over time chart -----------------------------------------------------------------------------------
trend_chart_adjusted_data <- filter(filter(filter(refined_data, latinx_jail_pop != "NA"),white_jail_pop != "NA"), total_jail_pop > 0)
trend_chart_adjusted_data <- summarise(group_by(trend_chart_adjusted_data, year), black_total_jail = sum(black_jail_pop), latinx_total_jail = sum(latinx_jail_pop), white_total_jail = sum(white_jail_pop), total_jail = sum(total_jail_pop))
plot(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$total_jail, pch = 15, ylim = c(0, 740000), main = "History of Jailed Population in the US", xlab = "Date", ylab = "Number of People in Jail")
lines(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$total_jail)
points(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$white_total_jail, pch = 16, col = "red")
lines(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$white_total_jail, col = "red")
points( x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$black_total_jail, pch = 17, col = "green")
lines(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$black_total_jail, col = "green")
points(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$latinx_total_jail, pch = 18, col = "blue")
lines(x=trend_chart_adjusted_data$year, y=trend_chart_adjusted_data$latinx_total_jail, col = "blue")
legend("topleft", c("Total American in Jail", "Total White American in Jail", "Total African American in Jail", "Total Latin American in Jail"),col = c("black", "red", "green", "blue"), pch = c(15, 16, 17, 18))
#Variable Comparison chart---------------------------------------------------------------------------------------------
var_compare_data <- filter(filter(filter(filter(refined_data, latinx_jail_pop != "NA"), latinx_pop_15to64 != "NA"), white_pop_15to64 != "NA"), total_jail_pop != "NA")
var_2010 <- summarise(filter(var_compare_data, year == 2010),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
var_2000 <- summarise(filter(var_compare_data, year == 2000),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
var_1990 <- summarise(filter(var_compare_data, year == 1990),
latinx = sum(latinx_jail_pop) / sum(latinx_pop_15to64),
white = sum(white_jail_pop) / sum(white_pop_15to64),
black = sum(black_jail_pop) / sum(black_pop_15to64),
overall = sum(total_jail_pop) / sum(total_pop))
overall_var_compare_df <- rbind(var_1990, var_2000, var_2010)
df_colname_2010 <- colnames(overall_var_compare_df)
df_catgory_2010 <- c(overall_var_compare_df$latinx, var_2010$white, var_2010$black, var_2010$overall)
df_year_2010 <- c(2010, 2010, 2010, 2010)
specie <- c(rep("sorgho" , 3) , rep("poacee" , 3) , rep("banana" , 3) , rep("triticum" , 3) )
condition <- rep(c("normal" , "stress" , "Nitrogen") , 4)
value <- abs(rnorm(12 , 0 , 15))
data <- data.frame(specie,condition,value)
View(data)
ggplot(overall_var_compare_df, aes(fill= colnames(overall_var_compare_df), y=value, x=specie)) +
geom_bar(position="fill", stat="identity")
ggplot(data, aes(fill=condition, y=value, x=specie)) +
geom_bar(position="stack", stat="identity") +
scale_fill_viridis(discrete = T) +
ggtitle("Studying 4 species..") +
theme_ipsum() +
xlab("")
df_catgory <- c(overall_var_compare_df$latinx, var_2010$white, var_2010$black, var_2010$overall)
df_catgory
df_year <- c(2010, 2010, 2010, 2010, 2000, 2000, 2000, 2000, 1990, 1990, 1990, 1990)
df_colname <- rep(colnames(overall_var_compare_df), 1:4)
df_colname <- rep(colnames(overall_var_compare_df), 4)
df_catgory <- c(overall_var_compare_df$latinx, var_2010$white, var_2010$black, var_2010$overall)
df_colname <- rep(colnames(overall_var_compare_df), 4)
df_catgory <- c(overall_var_compare_df$latinx, var_2010$white, var_2010$black, var_2010$overall)
df_year <- c(2010, 2010, 2010, 2010, 2000, 2000, 2000, 2000, 1990, 1990, 1990, 1990)
source("C:/Users/12064/a3-data-visualization-benedictwyt/Analysis.R")
df_year <- c(2010, 2010, 2010, 2010, 2010, 2000, 2000, 2000, 2000, 2000, 1990, 1990, 1990, 1990, 1990)
df_catgory
df_colname
df_catgory <- c(overall_var_compare_df$latinx[1:3], var_2010$white[1:3], var_2010$black[1:3], var_2010$overall[1:3])
df_year <- c(2010, 2010, 2010, 2010, 2000, 2000, 2000, 2000, 1990, 1990, 1990, 1990)
df_catgory
View(var_compare_data)
df_colname <- c("latinx", "latinx", "latinx", "white", "white", "white", "black", "black", "black", "overall", "overall", "overall")
df_catgory <- c(overall_var_compare_df$latinx[1:3], overall_var_compare_df$white[1:3], overall_var_compare_df$black[1:3], overall_var_compare_df$overall[1:3])
df_year <- c(1990, 2000, 2010, 1990, 2000, 2010, 1990, 2000, 2010, 1990, 2000, 2010)
data <- data.frame(specie,condition,value)
data_vc <- data.frame(df_colname, df_catgory, df_year)
View(data_vc)
data_vc <- arrange(data_vc, year)
ggplot(data_vc, aes(fill=race, y=race_jail_rate, x=year)) +
geom_bar(position="stack", stat="identity") +
scale_fill_viridis(discrete = T) +
ggtitle("Studying 4 species..") +
theme_ipsum() +
xlab("")
year <- c(1990, 2000, 2010, 1990, 2000, 2010, 1990, 2000, 2010, 1990, 2000, 2010)
source("C:/Users/12064/a3-data-visualization-benedictwyt/Analysis.R")
ggplot(data_vc, aes(fill=race, y=race_jail_rate, x=year)) +
geom_bar(position="stack", stat="identity") +
scale_fill_viridis(discrete = T) +
ggtitle("Studying 4 species..") +
theme_ipsum() +
xlab("")
ggplot(data_vc, aes(fill=race, y=race_jail_rate, x=year)) +
geom_bar(position="dodge", stat="identity") +
ggtitle("Studying 4 species..") +
theme_ipsum() +
xlab("")
source("C:/Users/12064/a3-data-visualization-benedictwyt/Analysis.R")
View(variable_chart)
variable_chart <- ggplot(data_vc, aes(fill=race, y=race_jail_rate, x=year)) +
geom_bar(position="dodge", stat="identity") +
ggtitle("The Jail Rate Across History based on Race") +
theme_ipsum() +
xlab("Time") + ylab("Percentage of People in Jail")
ggplot(data_vc, aes(fill=race, y=race_jail_rate, x=year)) +
geom_bar(position="dodge", stat="identity") +
ggtitle("The Jail Rate Across History based on Race") +
theme_ipsum() +
xlab("Time") + ylab("Percentage of People in Jail")
ggplot(data_vc, aes(fill=race, y=race_jail_rate, x=year)) +
geom_bar(position="dodge", stat="identity") +
ggtitle("The Jail Rate Across History based on Race") +
theme_ipsum() +
xlab("Time") + ylab("Percentage of People in Jail")
ggplot(data_vc, aes(fill=race, y=race_jail_rate, x=year)) +
geom_bar(position="dodge", stat="identity") +
ggtitle("The Jail Rate Across History based on Race") +
xlab("Time") + ylab("Percentage of People in Jail")
ggplot(data_vc, aes(fill=race, y=race_jail_rate, x=year)) +
geom_bar(position="dodge", stat="identity") +
ggtitle("The Jail Rate Across History based on Race") +
theme_ipsum() +
xlab("Time") + ylab("Percentage of People in Jail")
map_df <- summarise(group_by(filter(refined_data, year == max(year)), state),
state = state, jail_rate = black_jail_pop / black_pop_15to64)
View(map_df)
mapdf <- summarise(group_by(filter(refined_data, year == max(year)), state),
state = state, jail_rate = black_jail_pop / black_pop_15to64)
mapdf <- filter(mapdf, jail_rate != "NA")
View(mapdf)
mapdf <- summarise(group_by(filter(refined_data, year == max(year)), state),
jail_rate = black_jail_pop / black_pop_15to64)
mapdf <- filter(mapdf, jail_rate != "NA")
mapdf <- summarise(group_by(filter(refined_data, year == max(year)), state),
jail_rate = black_jail_pop / black_pop_15to64)
mapdf <- summarise(group_by(filter(refined_data, year == max(year)), state),
jail_rate = black_jail_pop / black_pop_15to64)
mapdf <- summarise(group_by(filter(refined_data, year == max(year)), state),
jail_rate = black_jail_pop / black_pop_15to64)
mapdf <- summarise(group_by(filter(refined_data, year == max(year)), state),
jail_rate = black_jail_pop / black_pop_15to64)
mapdf <- summarise(group_by(filter(refined_data, year == max(year)), state),
jail_rate = black_jail_pop / black_pop_15to64)
mapdf <- summarise(group_by(filter(refined_data, year == max(year)), state),
jail_rate = black_jail_pop / black_pop_15to64)
mapdf <- summarise(group_by(filter(refined_data, year == max(year)), state),
jail_rate = black_jail_pop / black_pop_15to64)
mapdf <- summarise(group_by(filter(refined_data, year == max(year)), state),
jail_rate = black_jail_pop / black_pop_15to64)
source("C:/Users/12064/a3-data-visualization-benedictwyt/Analysis.R")
mapdf <- summarise(group_by(filter(refined_data, year == max(year)), state),
jail_rate = sum(black_jail_pop) / sum(black_pop_15to64))
mapdf <- filter(mapdf, jail_rate != "NA")
spdf_fortified <- spdf_fortified %>%
left_join(. , data, by=c("id"="state"))
# Make a first chloropleth map
ggplot() +
geom_polygon(data = spdf_fortified, aes(fill =  y_2015, x = long, y = lat, group = group)) +
scale_fill_gradient(trans = "log") +
theme_void() +
coord_map()
library(hrbrthemes)
library(geojsonio)
library(RColorBrewer)
library(rgdal)
installed.packages(geojsonio)
install.packages("geojsonio")
install.packages("RColorBrewer")
install.packages("RColorBrewer")
spdf_fortified <- spdf_fortified %>%
left_join(. , data, by=c("id"="state"))
# Make a first chloropleth map
ggplot() +
geom_polygon(data = spdf_fortified, aes(fill =  y_2015, x = long, y = lat, group = group)) +
scale_fill_gradient(trans = "log") +
theme_void() +
coord_map()
source("C:/Users/12064/a3-data-visualization-benedictwyt/Analysis.R")
spdf_fortified <- spdf_fortified %>%
left_join(. , data, by=c("id"="state"))
# Make a first chloropleth map
ggplot() +
geom_polygon(data = spdf_fortified, aes(fill =  y_2015, x = long, y = lat, group = group)) +
scale_fill_gradient(trans = "log") +
theme_void() +
coord_map()
library(ggmap)
install.packages(ggmap)
install.packages("ggmap")
#Pakcage---------------------------------------------------------------------------
library(dplyr)
library(ggplot2)
library(stringr)
library(viridis)
library(hrbrthemes)
library(tidyverse)
library(ggmap)
install.packages("usmap")
library(usmap)
mapdata <- summarise(group_by(filter(refined_data, year == max(year)), state),
jail_rate = sum(black_jail_pop) / sum(black_pop_15to64))
mapdata <- filter(mapdf, jail_rate != "NA")
mapdata <- mapdata[order(mapdata$state), ]
mapdata <- statepop$fips
mapdata <- statepop$abbr
View(mapdf)
source("C:/Users/12064/a3-data-visualization-benedictwyt/Analysis.R")
View(mapdata)
mapdata <- mapdata[order(mapdata$state), ]
mapdata$fips <- statepop$fips
mapdata$abbr <- statepop$abbr
View(mapdata)
mapdata <- filter(mapdf, jail_rate != "NA")
mapdata <- summarise(group_by(filter(refined_data, year == max(year)), state),
jail_rate = sum(black_jail_pop) / sum(black_pop_15to64))
mapdata <- filter(mapdata, jail_rate != "NA")
mapdata <- mapdata[order(mapdata$state), ]
mapdata$fips <- statepop$fips
mapdata$abbr <- statepop$abbr
mapdata <- summarise(group_by(filter(refined_data, year == max(year)), state),
jail_rate = sum(black_jail_pop) / sum(black_pop_15to64))
mapdata <- filter(mapdata, jail_rate != "NA")
mapdata <- mapdata[order(mapdata$state), ]
mapdata$fips <- statepop$fips
mapdata$fips <- statepop$fips
mapdata <- summarise(group_by(filter(refined_data, year == 2015), state),
jail_rate = sum(black_jail_pop) / sum(black_pop_15to64))
mapdata <- filter(mapdata, jail_rate != "NA")
mapdata <- mapdata[order(mapdata$state), ]
mapdata$fips <- statepop$fips
mapdata$abbr <- statepop$abbr
mapdata <- summarise(group_by(filter(refined_data, year == 2010), state),
jail_rate = sum(black_jail_pop) / sum(black_pop_15to64))
mapdata <- filter(mapdata, jail_rate != "NA")
View(mapdata)
unique(refined_data$state)
mapdata <- summarise(group_by(filter(refined_data, year == 2010), state),
jail_rate = sum(black_jail_pop) / sum(black_pop_15to64))
ggplot(data_vc, aes(fill=race, y=race_jail_rate, x=year)) +
geom_bar(position="dodge", stat="identity") +
ggtitle("The Jail Rate Across History based on Race") +
theme_ipsum() +
xlab("Time") + ylab("Percentage of People in Jail")
View(data_vc)
mapdata <- summarise(group_by(filter(refined_data, year == 2010), state),
jail_rate = sum(black_jail_pop/ black_pop_15to64))
mapdata <- filter(mapdata, jail_rate != "NA")
mapdata <- summarise(group_by(filter(refined_data, year == 2010), state),
jail_rate = sum(black_jail_pop/ black_pop_15to64))
mapdata <- summarise(group_by(fiilter(filter(refined_data, year == 2010), black_jail_pop) , state),
jail_rate = sum(black_jail_pop/ black_pop_15to64))
mapdata <- summarise(group_by(filter(filter(refined_data, year == 2010), black_jail_pop) , state),
jail_rate = sum(black_jail_pop/ black_pop_15to64))
mapdata <- summarise(group_by(filter(filter(refined_data, year == 2010), black_jail_pop!= "NA") , state),
jail_rate = sum(black_jail_pop/ black_pop_15to64))
mapdata <- summarise(group_by(filter(filter(refined_data, year == 2018), black_jail_pop!= "NA") , state),
jail_rate = sum(black_jail_pop/ black_pop_15to64))
mapdata <- filter(mapdata, jail_rate != "NA")
mapdata <- mapdata[order(mapdata$state), ]
mapdata$fips <- statepop$fips
mapdata$abbr <- statepop$abbr
mapdata <- mutate(mapdata, state_all = unique(refined_data$state))
mapdata <- left_join(mapdata, state_all = unique(refined_data$state))
mapdata <- left_join(mapdata, unique(refined_data$state))
mapdata$fips <- filter(statepo, abbr == mapdata$state)[fips]
mapdata$fips <- filter(statepop, abbr == mapdata$state)[fips]
shiny::runApp('C:/Users/12064/final-projects-benedictwyt')
shiny::runApp('C:/Users/12064/final-projects-benedictwyt')
#Package---------------------------------------------------------------------------------------
library(shiny)
library(dplyr)
library(fmsb)
library(shinyWidgets)
#data-----------------------------------------------------------------------------------------
bank_VTBR_df <- read.csv("Radar Chart data/VTBR Historical Data.csv")
bank_VTBR_df <- select(bank_VTBR_df, ï..Date, Price)
ebank_QIWI_df <- read.csv("Radar Chart data/QIWIDR Historical Data.csv")
ebank_QIWI_df <- select(ebank_QIWI_df, ï..Date, Price)
telecom_MTSS_df <- read.csv("Radar Chart data/MTSS Historical Data.csv")
telecom_MTSS_df <- select(telecom_MTSS_df, ï..Date, Price)
oil_LKOH_df <- read.csv("Radar Chart data/LKOH Historical Data.csv")
oil_LKOH_df <- select(oil_LKOH_df, ï..Date, Price)
airline_AFLT_df <- read.csv("Radar Chart data/AFLT Historical Data.csv")
airline_AFLT_df <- select(airline_AFLT_df, ï..Date, Price)
char_df <- merge(bank_VTBR_df, ebank_QIWI_df, by = "ï..Date")
char_df <- merge(char_df, telecom_MTSS_df, by = "ï..Date")
char_df <- merge(char_df, oil_LKOH_df, by = "ï..Date")
char_df <- merge(char_df, airline_AFLT_df, by = "ï..Date")
setwd("C:/Users/12064/final-projects-benedictwyt")
#Package---------------------------------------------------------------------------------------
library(shiny)
library(dplyr)
library(fmsb)
library(shinyWidgets)
#data-----------------------------------------------------------------------------------------
bank_VTBR_df <- read.csv("Radar Chart data/VTBR Historical Data.csv")
bank_VTBR_df <- select(bank_VTBR_df, ï..Date, Price)
ebank_QIWI_df <- read.csv("Radar Chart data/QIWIDR Historical Data.csv")
ebank_QIWI_df <- select(ebank_QIWI_df, ï..Date, Price)
telecom_MTSS_df <- read.csv("Radar Chart data/MTSS Historical Data.csv")
telecom_MTSS_df <- select(telecom_MTSS_df, ï..Date, Price)
oil_LKOH_df <- read.csv("Radar Chart data/LKOH Historical Data.csv")
oil_LKOH_df <- select(oil_LKOH_df, ï..Date, Price)
airline_AFLT_df <- read.csv("Radar Chart data/AFLT Historical Data.csv")
airline_AFLT_df <- select(airline_AFLT_df, ï..Date, Price)
char_df <- merge(bank_VTBR_df, ebank_QIWI_df, by = "ï..Date")
char_df <- merge(char_df, telecom_MTSS_df, by = "ï..Date")
char_df <- merge(char_df, oil_LKOH_df, by = "ï..Date")
char_df <- merge(char_df, airline_AFLT_df, by = "ï..Date")
char_df <- arrange(char_df, - ï..Date)
char_df <- setNames(char_df, c("Date", "Bank","Ebank","Telecom", "Oil", "Airline"))
char_df <- arrange(char_df, -Date)
View(char_df)
typeof(char_df$Date)
